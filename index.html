<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Front Desk Checklist</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Library for exporting to Word -->
    <script src="https://unpkg.com/html-to-docx@1.8.0/dist/html-to-docx.js"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
        }
        .task-item input:checked + label {
            text-decoration: line-through;
            color: #6b7280;
        }
        .task-item input:checked + label .task-text {
            opacity: 0.7;
        }
        .progress-bar-fill {
            transition: width 0.5s ease-in-out;
        }
        .collapsible-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
        }
        .collapsible-header.active + .collapsible-content {
            max-height: 1000px; /* Adjust as needed */
        }
    </style>
</head>
<body class="p-4 sm:p-6 md:p-8">

    <div class="max-w-4xl mx-auto bg-white rounded-2xl shadow-lg p-6 sm:p-8">

        <!-- Header Section -->
        <header class="border-b pb-6 mb-6">
            <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center">
                <div>
                    <h1 class="text-3xl font-bold text-gray-800">Front Desk Checklist</h1>
                    <p class="text-gray-500 mt-1">Interactive checklist for daily front desk operations.</p>
                </div>
                <div class="mt-4 sm:mt-0 flex items-center space-x-4">
                    <input type="date" id="current-date" class="form-input rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50">
                    <select id="shift-select" class="form-select rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50">
                        <option>AM</option>
                        <option>PM</option>
                        <option>Night</option>
                    </select>
                </div>
            </div>
            <div class="mt-6">
                <div class="w-full bg-gray-200 rounded-full h-2.5">
                    <div id="progress-bar" class="bg-blue-600 h-2.5 rounded-full progress-bar-fill" style="width: 0%"></div>
                </div>
                <p id="progress-text" class="text-center text-sm text-gray-600 mt-2">0% Complete</p>
            </div>
        </header>

        <!-- Main Content -->
        <main id="checklist-container">
            
            <!-- At a Glance Section -->
            <div class="grid grid-cols-2 md:grid-cols-3 gap-4 mb-6">
                <div class="bg-gray-50 p-4 rounded-lg">
                    <label for="hskp-name" class="block text-sm font-medium text-gray-700">HSKP Name</label>
                    <input type="text" id="hskp-name" placeholder="Name..." class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm">
                </div>
                <div class="bg-gray-50 p-4 rounded-lg">
                    <label for="engineer-name" class="block text-sm font-medium text-gray-700">Engineer Name</label>
                    <input type="text" id="engineer-name" placeholder="Name..." class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm">
                </div>
                 <div class="bg-gray-50 p-4 rounded-lg">
                    <label for="occupancy" class="block text-sm font-medium text-gray-700">Projected Occupancy %</label>
                    <input type="number" id="occupancy" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm">
                </div>
                <div class="bg-gray-50 p-4 rounded-lg">
                    <label for="rate" class="block text-sm font-medium text-gray-700">$ Rate</label>
                    <input type="number" id="rate" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm">
                </div>
                <div class="bg-gray-50 p-4 rounded-lg">
                    <label for="enrollments" class="block text-sm font-medium text-gray-700">Hilton Honor Enrollments</label>
                    <input type="number" id="enrollments" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm">
                </div>
            </div>

            <!-- Meeting Rooms Section -->
            <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6">
                 <h3 class="font-semibold text-lg text-blue-800 mb-3">Meeting Room Parking Passes</h3>
                 <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-6 gap-4">
                    <div><label class="block text-sm">Saguaro</label><input type="number" data-id="saguaro-parking" class="mt-1 w-full form-input rounded-md border-gray-300"></div>
                    <div><label class="block text-sm">Cholla</label><input type="number" data-id="cholla-parking" class="mt-1 w-full form-input rounded-md border-gray-300"></div>
                    <div><label class="block text-sm">Navajo</label><input type="number" data-id="navajo-parking" class="mt-1 w-full form-input rounded-md border-gray-300"></div>
                    <div><label class="block text-sm">Yavapai</label><input type="number" data-id="yavapai-parking" class="mt-1 w-full form-input rounded-md border-gray-300"></div>
                    <div><label class="block text-sm">Agave</label><input type="number" data-id="agave-parking" class="mt-1 w-full form-input rounded-md border-gray-300"></div>
                    <div><label class="block text-sm">Atrium</label><input type="number" data-id="atrium-parking" class="mt-1 w-full form-input rounded-md border-gray-300"></div>
                 </div>
            </div>


            <!-- Main Checklist -->
            <div class="bg-white rounded-lg border border-gray-200 p-6">
                <h3 class="font-semibold text-xl text-gray-800 mb-4">Shift Tasks</h3>
                <ul id="task-list" class="space-y-4 text-gray-700">
                    <li class="task-item flex items-center"><input type="checkbox" id="task-1" class="h-5 w-5 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"><label for="task-1" class="ml-3 block"><span class="task-text">Verify Cash Drawer</span></label></li>
                    <li class="task-item flex items-center"><input type="checkbox" id="task-2" class="h-5 w-5 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"><label for="task-2" class="ml-3 block"><span class="task-text">Review Email & Calendar for DAILY EVENTS and Group info resumes.</span></label></li>
                    <li class="task-item flex items-center"><input type="checkbox" id="task-3" class="h-5 w-5 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"><label for="task-3" class="ml-3 block"><span class="task-text">Print CRM from the Lobby.</span></label></li>
                    <li class="task-item flex items-center"><input type="checkbox" id="task-4" class="h-5 w-5 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"><label for="task-4" class="ml-3 block"><span class="task-text">Use TRACES and GUEST COMMENTS report to assign rooms.</span></label></li>
                    <li class="task-item flex items-center"><input type="checkbox" id="task-5" class="h-5 w-5 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"><label for="task-5" class="ml-3 block"><span class="task-text">Discuss with MOD any guests with notes that are NOT ALLOWED TO STAY.</span></label></li>
                    <li class="task-item flex items-center"><input type="checkbox" id="task-6" class="h-5 w-5 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"><label for="task-6" class="ml-3 block"><span class="task-text">Log into SP2 SYSTEMS and log all engineering and housekeeping requests.</span></label></li>
                    <li class="task-item flex items-center"><input type="checkbox" id="task-7" class="h-5 w-5 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"><label for="task-7" class="ml-3 block"><span class="task-text">Login into Nor1 Upgrades Portal.</span></label></li>
                    <li class="task-item flex items-center"><input type="checkbox" id="task-8" class="h-5 w-5 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"><label for="task-8" class="ml-3 block"><span class="task-text">Check for upgrades, Realize or Deny requests 4 days in advance.</span></label></li>
                    
                    <!-- Packet Section -->
                    <li id="packet-section">
                        <div class="space-y-3">
                            <!-- First Packet -->
                            <div class="bg-gray-50 rounded-lg border border-gray-200">
                                <div class="collapsible-header p-3 cursor-pointer flex justify-between items-center">
                                    <h4 class="font-semibold text-gray-700">First Packet</h4>
                                    <svg class="w-5 h-5 transform transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                                </div>
                                <div class="collapsible-content">
                                    <ul class="p-4 pt-2 space-y-2 text-gray-600">
                                        <li class="task-item flex items-center"><input type="checkbox" id="packet1-vips" class="h-5 w-5 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"><label for="packet1-vips" class="ml-3 block"><span class="task-text">VIPs</span></label></li>
                                        <li class="task-item flex items-center"><input type="checkbox" id="packet1-guest-comment" class="h-5 w-5 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"><label for="packet1-guest-comment" class="ml-3 block"><span class="task-text">Guest Comment Report</span></label></li>
                                        <li class="task-item flex items-center"><input type="checkbox" id="packet1-high-balance" class="h-5 w-5 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"><label for="packet1-high-balance" class="ml-3 block"><span class="task-text">High Balances</span></label></li>
                                        <li class="task-item flex items-center"><input type="checkbox" id="packet1-traces" class="h-5 w-5 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"><label for="packet1-traces" class="ml-3 block"><span class="task-text">Traces</span></label></li>
                                    </ul>
                                </div>
                            </div>
                            <!-- Second Packet -->
                            <div class="bg-gray-50 rounded-lg border border-gray-200">
                                <div class="collapsible-header p-3 cursor-pointer flex justify-between items-center">
                                    <h4 class="font-semibold text-gray-700">Second Packet</h4>
                                    <svg class="w-5 h-5 transform transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                                </div>
                                <div class="collapsible-content">
                                    <ul class="p-4 pt-2 space-y-2 text-gray-600">
                                        <li class="task-item flex items-center"><input type="checkbox" id="packet2-high-balance" class="h-5 w-5 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"><label for="packet2-high-balance" class="ml-3 block"><span class="task-text">High Balances</span></label></li>
                                        <li class="task-item flex items-center"><input type="checkbox" id="packet2-traces" class="h-5 w-5 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"><label for="packet2-traces" class="ml-3 block"><span class="task-text">Traces</span></label></li>
                                    </ul>
                                </div>
                            </div>
                            <!-- Third Packet -->
                            <div class="bg-gray-50 rounded-lg border border-gray-200">
                                <div class="collapsible-header p-3 cursor-pointer flex justify-between items-center">
                                    <h4 class="font-semibold text-gray-700">Third Packet</h4>
                                    <svg class="w-5 h-5 transform transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                                </div>
                                <div class="collapsible-content">
                                    <ul class="p-4 pt-2 space-y-2 text-gray-600">
                                        <li class="task-item flex items-center"><input type="checkbox" id="packet3-high-balance" class="h-5 w-5 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"><label for="packet3-high-balance" class="ml-3 block"><span class="task-text">High Balances</span></label></li>
                                        <li class="task-item flex items-center"><input type="checkbox" id="packet3-traces" class="h-5 w-5 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"><label for="packet3-traces" class="ml-3 block"><span class="task-text">Traces</span></label></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </li>

                    <li class="task-item flex items-center"><input type="checkbox" id="task-10" class="h-5 w-5 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"><label for="task-10" class="ml-3 block"><span class="task-text">Prepare Digital check-in bags.</span></label></li>
                    <li class="task-item flex items-center"><input type="checkbox" id="task-11" class="h-5 w-5 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"><label for="task-11" class="ml-3 block"><span class="task-text">Complete E-check-in dashboard.</span></label></li>
                    <li class="task-item flex items-center"><input type="checkbox" id="task-12" class="h-5 w-5 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"><label for="task-12" class="ml-3 block"><span class="task-text">Print Remaining arrivals.</span></label></li>
                    <li class="task-item flex items-center"><input type="checkbox" id="task-13" class="h-5 w-5 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"><label for="task-13" class="ml-3 block"><span class="task-text">Ensure 7+ night stays have a trace set for 7th day payment.</span></label></li>
                    <li class="task-item flex items-center"><input type="checkbox" id="task-14" class="h-5 w-5 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"><label for="task-14" class="ml-3 block"><span class="task-text">Ensure 3rd Party Reservations are set up correctly (Rate Hidden, Receipt A Cash, Receipt B Confidential).</span></label></li>
                    <li class="task-item flex items-center"><input type="checkbox" id="task-15" class="h-5 w-5 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"><label for="task-15" class="ml-3 block"><span class="task-text">Charge 3rd party CC in advance (ON The Day of).</span></label></li>
                    <li class="task-item flex items-center"><input type="checkbox" id="task-16" class="h-5 w-5 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"><label for="task-16" class="ml-3 block"><span class="task-text">Log into SERTIFI.</span></label></li>
                    <li class="task-item flex items-center"><input type="checkbox" id="task-17" class="h-5 w-5 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"><label for="task-17" class="ml-3 block"><span class="task-text">Process ECONFIRMATIONS and regular CCA FORMS.</span></label></li>
                    <li class="task-item flex items-center"><input type="checkbox" id="task-18" class="h-5 w-5 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"><label for="task-18" class="ml-3 block"><span class="task-text">View Account Detail > Direct Bill.</span></label></li>
                    <li class="task-item flex items-center"><input type="checkbox" id="task-19" class="h-5 w-5 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"><label for="task-19" class="ml-3 block"><span class="task-text">Research any Refund Credit cards.</span></label></li>
                    <li class="task-item flex items-center"><input type="checkbox" id="task-20" class="h-5 w-5 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"><label for="task-20" class="ml-3 block"><span class="task-text">Throughout the day check for NKJB rooms and change to any room available.</span></label></li>
                    <li class="task-item flex items-center"><input type="checkbox" id="task-21" class="h-5 w-5 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"><label for="task-21" class="ml-3 block"><span class="task-text">Assign pet rooms to 2nd floor and add Trace for HSKP to deep clean.</span></label></li>
                    <li class="task-item flex items-center"><input type="checkbox" id="task-22" class="h-5 w-5 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"><label for="task-22" class="ml-3 block"><span class="task-text">If digital guest has a pet, ask to move to a pet friendly room and charge pet fee.</span></label></li>
                    <li class="task-item flex items-center"><input type="checkbox" id="task-23" class="h-5 w-5 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"><label for="task-23" class="ml-3 block"><span class="task-text">Prepare coffee station in lobby after breakfast is over.</span></label></li>
                    <li class="task-item flex items-center"><input type="checkbox" id="task-24" class="h-5 w-5 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"><label for="task-24" class="ml-3 block"><span class="task-text">Use tape chart in OnQ to clear any gaps in room assignments.</span></label></li>
                    <li class="task-item flex items-center"><input type="checkbox" id="task-25" class="h-5 w-5 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"><label for="task-25" class="ml-3 block"><span class="task-text">Handle DAY USE rooms based on occupancy (<75% stay, >75% checkout).</span></label></li>
                    <li class="task-item flex items-center"><input type="checkbox" id="task-26" class="h-5 w-5 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"><label for="task-26" class="ml-3 block"><span class="task-text">Stock and check freshness of food, drinks, and sundries in Marketplace.</span></label></li>
                    <li class="task-item flex items-center"><input type="checkbox" id="task-27" class="h-5 w-5 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"><label for="task-27" class="ml-3 block"><span class="task-text">ORDER GRAB AND GO FOOD IF NEEDED (good for 3 days).</span></label></li>
                    <li class="task-item flex items-center"><input type="checkbox" id="task-28" class="h-5 w-5 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"><label for="task-28" class="ml-3 block"><span class="task-text">Wipe microwave.</span></label></li>
                    <li class="task-item flex items-center"><input type="checkbox" id="task-29" class="h-5 w-5 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"><label for="task-29" class="ml-3 block"><span class="task-text">Restock amenities (shaving cream, razors, shampoo, etc.).</span></label></li>
                    <li class="task-item flex items-center"><input type="checkbox" id="task-30" class="h-5 w-5 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"><label for="task-30" class="ml-3 block"><span class="task-text">Restock pens, paper, water bags, room keys, parking tags, etc.</span></label></li>
                    <li class="task-item flex items-center"><input type="checkbox" id="task-31" class="h-5 w-5 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"><label for="task-31" class="ml-3 block"><span class="task-text">Ensure Hilton Honor water bags and snack bags are ready.</span></label></li>
                    <li class="task-item flex items-center"><input type="checkbox" id="task-32" class="h-5 w-5 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"><label for="task-32" class="ml-3 block"><span class="task-text">Check incoming and outgoing packages and text guest.</span></label></li>
                    <li class="task-item flex items-center"><input type="checkbox" id="task-33" class="h-5 w-5 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"><label for="task-33" class="ml-3 block"><span class="task-text">If 4 or less rooms to sell, you may sell at lowest of $199 (one night, not extendable).</span></label></li>
                    <li class="task-item flex items-center"><input type="checkbox" id="task-34" class="h-5 w-5 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"><label for="task-34" class="ml-3 block"><span class="task-text">Check SP and communicate with HSKP and ENG what is still pending.</span></label></li>
                    <li class="task-item flex items-center"><input type="checkbox" id="task-35" class="h-5 w-5 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"><label for="task-35" class="ml-3 block"><span class="task-text">Ensure parking for current day reservations and add parking for 2 days in advance.</span></label></li>
                    <li class="task-item flex items-center"><input type="checkbox" id="task-36" class="h-5 w-5 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"><label for="task-36" class="ml-3 block"><span class="task-text">Count cash drawers 15 minutes before end of shift.</span></label></li>
                    <li class="task-item flex items-center"><input type="checkbox" id="task-37" class="h-5 w-5 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"><label for="task-37" class="ml-3 block"><span class="task-text">Trace listing (ten mins. before departure).</span></label></li>
                    <li class="task-item flex items-center"><input type="checkbox" id="task-38" class="h-5 w-5 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"><label for="task-38" class="ml-3 block"><span class="task-text">Close Accounts (Guest, Shift Balance, Cash & Account under your ID) and drop envelope in safe.</span></label></li>
                    <li class="task-item flex items-center"><input type="checkbox" id="task-39" class="h-5 w-5 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"><label for="task-39" class="ml-3 block"><span class="task-text">Ensure your Kipsu dashboard Welcome messages to send is clear.</span></label></li>
                    <li class="task-item flex items-center"><input type="checkbox" id="task-40" class="h-5 w-5 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"><label for="task-40" class="ml-3 block"><span class="task-text">Review Stay Experience comments and close alerts.</span></label></li>
                    <li class="task-item flex items-center"><input type="checkbox" id="task-41" class="h-5 w-5 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"><label for="task-41" class="ml-3 block"><span class="task-text">Engage and ask each NON-honors member to join. (Goal: 8/month)</span></label></li>
                    <li class="task-item flex items-center"><input type="checkbox" id="task-42" class="h-5 w-5 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"><label for="task-42" class="ml-3 block"><span class="task-text">Check Digital Dashboard Every 2 Hours.</span></label></li>
                </ul>
            </div>
            
            <!-- Notes Section -->
            <div class="mt-6">
                <label for="shift-notes" class="block text-lg font-semibold text-gray-700">Shift Report & Notes for Incoming GSAs and MODs</label>
                <textarea id="shift-notes" rows="4" class="mt-2 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm" placeholder="Enter any important notes for the next shift..."></textarea>
            </div>

        </main>

        <!-- Footer / Actions -->
        <footer class="mt-8 pt-6 border-t flex flex-col sm:flex-row justify-end sm:space-x-4 space-y-3 sm:space-y-0">
            <button id="export-button" class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-lg shadow transition-colors">
                Export to Word
            </button>
            <button id="reset-button" class="bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-lg shadow transition-colors">
                Reset Checklist for Next Shift
            </button>
        </footer>

    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const container = document.getElementById('checklist-container');
            const inputs = document.querySelectorAll('input[type="checkbox"], input[type="number"], input[type="text"], textarea, select');
            const checkboxes = document.querySelectorAll('input[type="checkbox"]');
            const progressBar = document.getElementById('progress-bar');
            const progressText = document.getElementById('progress-text');
            const resetButton = document.getElementById('reset-button');
            const exportButton = document.getElementById('export-button');
            const dateInput = document.getElementById('current-date');
            const shiftSelect = document.getElementById('shift-select');
            const collapsibles = document.querySelectorAll('.collapsible-header');

            // Set current date
            dateInput.valueAsDate = new Date();

            // --- LOCAL STORAGE FUNCTIONS ---
            function saveState() {
                const state = {};
                inputs.forEach(input => {
                    const id = input.id || input.dataset.id;
                    if (!id) return;

                    if (input.type === 'checkbox') {
                        state[id] = input.checked;
                    } else {
                        state[id] = input.value;
                    }
                });
                localStorage.setItem('frontDeskChecklistState', JSON.stringify(state));
                updateProgress();
            }

            function loadState() {
                const state = JSON.parse(localStorage.getItem('frontDeskChecklistState'));
                if (state) {
                    inputs.forEach(input => {
                        const id = input.id || input.dataset.id;
                        if (id && state[id] !== undefined) {
                            if (input.type === 'checkbox') {
                                input.checked = state[id];
                            } else {
                                input.value = state[id];
                            }
                        }
                    });
                }
                updateProgress();
            }

            // --- UI FUNCTIONS ---
            function updateProgress() {
                const totalTasks = checkboxes.length;
                if (totalTasks === 0) return;
                const completedTasks = Array.from(checkboxes).filter(cb => cb.checked).length;
                const percentage = Math.round((completedTasks / totalTasks) * 100);
                
                progressBar.style.width = percentage + '%';
                progressText.textContent = `${percentage}% Complete (${completedTasks} / ${totalTasks} tasks)`;
            }

            function resetChecklist() {
                if (confirm('Are you sure you want to reset the entire checklist? This cannot be undone.')) {
                    document.querySelectorAll('#checklist-container input, #checklist-container textarea').forEach(input => {
                         if (input.type === 'checkbox') {
                            input.checked = false;
                        } else {
                            input.value = '';
                        }
                    });
                    saveState();
                }
            }

            // --- EXPORT FUNCTION ---
            async function exportToWord() {
                let reportHtml = `
                    <h1>Front Desk Shift Report</h1>
                    <p><strong>Date:</strong> ${dateInput.value}</p>
                    <p><strong>Shift:</strong> ${shiftSelect.value}</p>
                    <hr>
                    <h2>At a Glance</h2>
                    <ul>
                        <li><strong>HSKP on Duty:</strong> ${document.getElementById('hskp-name').value || 'N/A'}</li>
                        <li><strong>Engineer on Duty:</strong> ${document.getElementById('engineer-name').value || 'N/A'}</li>
                        <li><strong>Projected Occupancy:</strong> ${document.getElementById('occupancy').value || 'N/A'}%</li>
                        <li><strong>$ Rate:</strong> $${document.getElementById('rate').value || 'N/A'}</li>
                        <li><strong>Hilton Honor Enrollments:</strong> ${document.getElementById('enrollments').value || 'N/A'}</li>
                    </ul>
                    <h2>Meeting Room Parking Passes</h2>
                     <ul>
                        <li><strong>Saguaro:</strong> ${document.querySelector('[data-id="saguaro-parking"]').value || '0'}</li>
                        <li><strong>Cholla:</strong> ${document.querySelector('[data-id="cholla-parking"]').value || '0'}</li>
                        <li><strong>Navajo:</strong> ${document.querySelector('[data-id="navajo-parking"]').value || '0'}</li>
                        <li><strong>Yavapai:</strong> ${document.querySelector('[data-id="yavapai-parking"]').value || '0'}</li>
                        <li><strong>Agave:</strong> ${document.querySelector('[data-id="agave-parking"]').value || '0'}</li>
                        <li><strong>Atrium:</strong> ${document.querySelector('[data-id="atrium-parking"]').value || '0'}</li>
                    </ul>
                    <hr>
                    <h2>Shift Tasks</h2><ul>`;

                const taskListItems = document.getElementById('task-list').children;
                for (const item of taskListItems) {
                    if (item.id === 'packet-section') {
                        item.querySelectorAll('.collapsible-header').forEach(header => {
                            const packetTitle = header.querySelector('h4').textContent;
                            reportHtml += `<li><strong>${packetTitle}</strong></li>`;
                            const subTaskList = header.nextElementSibling.querySelector('ul');
                            reportHtml += `<ul>`;
                            subTaskList.querySelectorAll('li.task-item').forEach(subtask => {
                                const checkbox = subtask.querySelector('input[type="checkbox"]');
                                const label = subtask.querySelector('label').textContent;
                                const status = checkbox.checked ? '✓ Completed' : '✗ Pending';
                                reportHtml += `<li><strong>[${status}]</strong> ${label}</li>`;
                            });
                            reportHtml += `</ul>`;
                        });
                    } else if (item.classList.contains('task-item')) {
                        const checkbox = item.querySelector('input[type="checkbox"]');
                        const label = item.querySelector('label').textContent;
                        const status = checkbox.checked ? '✓ Completed' : '✗ Pending';
                        reportHtml += `<li><strong>[${status}]</strong> ${label}</li>`;
                    }
                }
                reportHtml += `</ul>`;

                reportHtml += `<hr><h2>Shift Report & Notes</h2>`;
                const notes = document.getElementById('shift-notes').value.replace(/\n/g, '<br>');
                reportHtml += `<p>${notes || 'No notes entered.'}</p>`;

                const blob = await htmlToDocx.asBlob(reportHtml, {
                    orientation: 'portrait',
                    margins: {
                        top: 720, // 1 inch
                        bottom: 720,
                        left: 720,
                        right: 720
                    }
                });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `FrontDeskReport-${dateInput.value}-${shiftSelect.value}.docx`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            }


            // --- EVENT LISTENERS ---
            document.body.addEventListener('change', saveState);
            resetButton.addEventListener('click', resetChecklist);
            exportButton.addEventListener('click', exportToWord);

            collapsibles.forEach(header => {
                header.addEventListener('click', function() {
                    this.classList.toggle('active');
                    const icon = this.querySelector('svg');
                    icon.classList.toggle('rotate-180');
                });
            });

            // --- INITIALIZATION ---
            loadState();
        });
    </script>

</body>
</html>
